<div flex ng-controller="managerController" layout="column">

  <md-content ng-init="menuNavItem = 'manager'" style="height: 70px;">
		<md-nav-bar class="wazuhMenuNav" md-selected-nav-item="menuNavItem" nav-bar-aria-label="navigation menu">
			<md-nav-item id="header_logo" md-nav-href="#/" name="logo" aria-hidden="true">
				<img aria-hidden="true" src="/plugins/wazuh/img/logo_white.png" height="44" weight="252"></img>
			</md-nav-item>
			<md-nav-item md-nav-href="#/agents" name="agents">Agents</md-nav-item>
			<md-nav-item md-nav-href="#/manager" name="manager">Manager</md-nav-item>
			<md-nav-item md-nav-href="#/ruleset" name="ruleset">Ruleset</md-nav-item>
			<md-nav-item md-nav-href="#/settings" name="settings">Settings</md-nav-item>
		</md-nav-bar>
	</md-content>

  <md-content class="md-padding">
    <md-nav-bar md-selected-nav-item="submenuNavItem" nav-bar-aria-label="navigation links">
      <md-nav-item md-nav-href="#/manager" name="general">General</md-nav-item>
      <md-nav-item md-nav-href="#/manager/configuration" name="configuration">Configuration</md-nav-item>
      <md-nav-item md-nav-href="#/manager/osseclog" name="logs">Logs</md-nav-item>
    </md-nav-bar>
  </md-content>

  <md-progress-linear md-mode="indeterminate" ng-show="load"></md-progress-linear>

  <md-content flex layout="column" ng-if="!load" layout-align="space-around">
	<div flex="10" layout="row"  layout-align=" center">
		<md-card flex>
			<md-card-title>
				<md-card-title-text>
					<span class="md-headline">Events</span>
				</md-card-title-text>
			</md-card-title>
			<md-card-content>
				<kbn-vis vis-height="200px;" vis-type="histogram" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(customInterval:'2h',extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1),schema:segment,type:date_histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,defaultYExtents:!f,mode:stacked,scale:linear,setYExtents:!f,shareYAxis:!t,times:!(),yAxis:()),title:'New%20Visualization',type:histogram))"
					vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="*">
				</kbn-vis>
			</md-card-content>
		</md-card>
		
		<md-card flex>
			<md-card-title>
				<md-card-title-text>
					<span class="md-headline">Signatures</span>
				</md-card-title-text>
			</md-card-title>
			<md-card-content>
				<kbn-vis vis-height="200px;" vis-type="histogram" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'3',params:(field:rule.description,order:desc,orderBy:'1',size:10),schema:group,type:terms),(enabled:!t,id:'2',params:(customInterval:'2h',extended_bounds:(),field:'@timestamp',interval:h,min_doc_count:1),schema:segment,type:date_histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,defaultYExtents:!f,interpolate:linear,mode:stacked,scale:linear,setYExtents:!f,shareYAxis:!t,smoothLines:!f,times:!(),yAxis:()),title:'Signature:%20Area%20Chart',type:area))"
					vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="*">
				</kbn-vis>
			</md-card-content>
		</md-card>
	</div>	
	
      <div flex="90" layout="row" layout-align="start stretch">
        <md-card flex layout="column">
          <md-card-content>
            <span layout="row" layout-align="space-between center">
              <h3>Manager status</h3>
              <h3 class="right-text"><md-icon md-font-icon="fa fa-cog" ng-click="showDialog()" /></h3>
            </span>
            <span layout="column" ng-repeat="daemon in daemons">
                <span layout="row" layout-align="space-between center">
                  <p>{{daemon.daemon}}</p>
                  <p class="right-text"><span ng-class="getDaemonStatusClass(daemon.status)" class="round" style="float: right"></span></p>
            </span>
            <md-divider></md-divider>
            </span>
          </md-card-content>
        </md-card>
		
		<md-card flex  layout="column">
		
			<md-card-content>
			<span class="md-headline">Top 5 Agents</span>
				<kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:AgentName,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'Agents%20total%20alerts',type:pie))"
					vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="*">
				</kbn-vis>
			</md-card-content>
		</md-card>
				
		<md-card flex layout="column">
          <md-card-content>
            <h3>Agents overview</h3>
            <md-list>
              <md-list-item>
                <p>Total agents</p>
                <p class="right-text">{{agentsCountTotal}}</p>
              </md-list-item>
              <md-divider></md-divider>
              <md-list-item>
                <p>Active</p>
                <p class="right-text">{{agentsCountActive}}</p>
              </md-list-item>
              <md-divider></md-divider>
              <md-list-item>
                <p>Disconnected</p>
                <p class="right-text">{{agentsCountDisconnected}}</p>
              </md-list-item>
              <md-divider></md-divider>
              <md-list-item>
                <p>Never connected</p>
                <p class="right-text">{{agentsCountNeverConnected}}</p>
              </md-list-item>
              <md-divider></md-divider>
              <md-divider></md-divider>
            </md-list>
          </md-card-content>
        </md-card>
		
		<md-card flex  layout="column"  layout-align="start stretch">
			<md-card-content>
				<span class="md-headline">Top 5 Groups</span>
				<kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:rule.groups,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'Alerts:%20Top%205%20Groups',type:pie))"
					vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="*">
				</kbn-vis>
			</md-card-content>
		</md-card>	
		
		

	
		
      </div>

  </md-content>

  <div style="display: none">
    <div class="md-dialog-container" id="actionsDialog">
      <md-dialog layout-padding layout="column" layout-align="space-around center">
        <md-button class="md-raised md-primary" ng-click="start()">Start</md-button>
        <md-button class="md-raised md-primary" ng-click="stop()">Stop</md-button>
        <md-button class="md-raised md-primary" ng-click="restart()">Restart</md-button>
      </md-dialog>
    </div>
  </div>


</div>
