<md-content flex layout="column" ng-if="tab === 'pm' && tabView === 'panels'" ng-show="!showRootcheckScan" ng-class="{'no-opacity': resultState !== 'ready' || !rendered}"
    layout-align="start">
    <div layout="row" layout-padding class="wz-padding-top-0">
        <span flex></span>
        <span ng-click="launchRootcheckScan()" class="btn pull-right btn-primary"><i class="fa fa-fw fa-play"></i> Run
            scan</span>
        <span></span>
        <span ng-click="switchRootcheckScan()" class="btn pull-right btn-primary"><i class="fa fa-fw fa-database"></i>
            Show state</span>
    </div>
    <div layout="row" class="height-240">
        <md-card flex="50" class="wz-md-card" ng-class="{'fullscreen': expandArray[0]}">
            <md-card-content class="wazuh-column">
                <div layout="row">
                    <span class="wz-headline-title">Alerts over time</span>
                    <span flex></span>
                    <span class="wz-text-link" ng-click="expand(0)"><i class="fa fa-fw fa-expand"></i></span>
                </div>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis id="Wazuh-App-Agents-PM-Alerts-over-time" vis-id="'Wazuh-App-Agents-PM-Alerts-over-time'"></kbn-vis>
            </md-card-content>
        </md-card>
        <md-card flex="25" class="wz-md-card" ng-class="{'fullscreen': expandArray[1]}">
            <md-card-content class="wazuh-column">
                <div layout="row">
                    <span class="wz-headline-title">Top 5 CIS Requirements</span>
                    <span flex></span>
                    <span class="wz-text-link" ng-click="expand(1)"><i class="fa fa-fw fa-expand"></i></span>
                </div>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis id="Wazuh-App-Agents-PM-Top-5-CIS-Requirements" vis-id="'Wazuh-App-Agents-PM-Top-5-CIS-Requirements'"></kbn-vis>
            </md-card-content>
        </md-card>
        <md-card flex="25" class="wz-md-card" ng-class="{'fullscreen': expandArray[2]}">
            <md-card-content class="wazuh-column">
                <div layout="row">
                    <span class="wz-headline-title">Top 5 PCI DSS Requirements</span>
                    <span flex></span>
                    <span class="wz-text-link" ng-click="expand(2)"><i class="fa fa-fw fa-expand"></i></span>
                </div>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis id="Wazuh-App-Agents-PM-Top-5-PCI-DSS-Requirements" vis-id="'Wazuh-App-Agents-PM-Top-5-PCI-DSS-Requirements'"></kbn-vis>
            </md-card-content>
        </md-card>
    </div>

    <div layout="row" layout-align="space-between stretch" class="height-570">
        <md-card flex="100" class="wz-md-card" ng-class="{'fullscreen': expandArray[3]}">
            <md-card-content class="wazuh-column">
                <div layout="row">
                    <span class="wz-headline-title">Alerts summary</span>
                    <span flex></span>
                    <span class="wz-text-link" ng-click="expand(3)"><i class="fa fa-fw fa-expand"></i></span>
                </div>
                <md-divider class="wz-margin-top-10"></md-divider>
                <kbn-vis vis-id="'Wazuh-App-Agents-PM-Alerts-summary'"></kbn-vis>
            </md-card-content>
        </md-card>
    </div>
</md-content>

<md-content flex layout="column" ng-if="tab === 'pm' && tabView === 'panels' && showRootcheckScan" layout-align="start">
    <div layout="row" layout-padding>
        <span flex></span>
        <span ng-click="launchRootcheckScan()" class="btn pull-right btn-primary"><i class="fa fa-fw fa-play"></i> Run
            scan</span>
        <span></span>
        <span ng-click="switchRootcheckScan()" class="btn pull-right btn-primary"><i class="fa fa-fw fa-area-chart"></i>
            Show alerts</span>
    </div>

    <div layout="row" class="wz-margin-top-10 wz-margin-right-8 wz-margin-left-8" ng-if="showRootcheckScan && (!agent || !agent.os)">
        <div flex class="euiCallOut euiCallOut--warning">
            <div class="euiCallOutHeader">
                <svg class="euiIcon euiIcon--medium euiCallOutHeader__icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 16 16">
                    <defs>
                        <path id="help-a" d="M13.6 12.186l-1.357-1.358c-.025-.025-.058-.034-.084-.056.53-.794.84-1.746.84-2.773a4.977 4.977 0 0 0-.84-2.772c.026-.02.059-.03.084-.056L13.6 3.813a6.96 6.96 0 0 1 0 8.373zM8 15A6.956 6.956 0 0 1 3.814 13.6l1.358-1.358c.025-.025.034-.057.055-.084C6.02 12.688 6.974 13 8 13a4.978 4.978 0 0 0 2.773-.84c.02.026.03.058.056.083l1.357 1.358A6.956 6.956 0 0 1 8 15zm-5.601-2.813a6.963 6.963 0 0 1 0-8.373l1.359 1.358c.024.025.057.035.084.056A4.97 4.97 0 0 0 3 8c0 1.027.31 1.98.842 2.773-.027.022-.06.031-.084.056l-1.36 1.358zm5.6-.187A4 4 0 1 1 8 4a4 4 0 0 1 0 8zM8 1c1.573 0 3.019.525 4.187 1.4l-1.357 1.358c-.025.025-.035.057-.056.084A4.979 4.979 0 0 0 8 3a4.979 4.979 0 0 0-2.773.842c-.021-.027-.03-.059-.055-.084L3.814 2.4A6.957 6.957 0 0 1 8 1zm0-1a8.001 8.001 0 1 0 .003 16.002A8.001 8.001 0 0 0 8 0z"></path>
                    </defs>
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#help-a" fill-rule="evenodd"></use>
                </svg>
                <span class="euiCallOutHeader__title">This agent is never connected.</span>
            </div>
        </div>
    </div>

    <div layout="row" class="wz-padding-top-0" ng-show="agent && agent.os && !lookingAssessment">
        <md-card flex class="wz-md-card">
            <md-card-content>
                <span class="wz-headline-title"><i class="fa fa-fw fa-shield"></i> Configuration assessment</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-margin-top-10" ng-repeat="policy in policies">
                    <span flex class="wz-text-link" ng-click="loadAssessmentChecks(policy)">{{policy.name}}</span>
                    <span flex class="wz-text-center">
                        <span class="red wz-text-bold wz-padding-left-16 wz-padding-right-16 color-white" tooltip="Fail">{{policy.fail}}</span>
                        <span class="green wz-text-bold wz-padding-left-16 wz-padding-right-16 color-white" tooltip="Pass">{{policy.pass}}</span>
                    </span>
                    <span flex>Score: <strong>{{policy.score}}</strong></span>
                    <span flex><a href="{{policy.references}}">{{policy.references}}</a></span>
                </div>
                <div layout="row" class="wz-margin-top-10" ng-if="!load && (!policies || !policies.length)">
                    <span flex><i class="fa fa-fw fa-warning"></i> No scans available.</span>
                </div>
            </md-card-content>
        </md-card>
    </div>

    <div layout="row" class="wz-padding-top-0" ng-if="agent && agent.os && lookingAssessment">
        <md-card flex class="wz-md-card">
            <md-card-content>
                <span class="wz-headline-title"><i class="fa fa-fw fa-arrow-left cursor-pointer" ng-click="closeAssessmentChecks()"></i>
                    {{lookingAssessment.name}} checks</span>
                <md-divider class="wz-margin-top-10"></md-divider>
                <div layout="row" class="wz-margin-top-10" ng-repeat="policy in policies">
                    <wz-table flex path="'/configuration_assessment/' + agent.id + '/checks/' + lookingAssessment.id"
                        row-sizes="[6,6,6]" extra-limit="500" keys="['title','file','remediation','process','description','references','result']">
                    </wz-table>
                </div>
            </md-card-content>
        </md-card>
    </div>
</md-content>