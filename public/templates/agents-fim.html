<md-content ng-if="submenuNavItem == 'fim'" ng-show="_agent" class="md-padding">
    <div ng-controller="fimController">

        <md-content layout="row" layout-align="end start">
            <md-content layout="row" layout-align="end start">
                <div class="statusBox md-whiteframe-3dp" layout="row" layout-align="space-between center">Time window: Last 7 days</div>
            </md-content>
        </md-content>

        <md-content layout="row">
            <md-card flex="50">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">FIM Alerts by hour of day</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="line" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups: &quot;syscheck &quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'3',params:(),schema:radius,type:count),(enabled:!t,id:'4',params:(extended_bounds:(),field:hour_of_day,interval:1),schema:segment,type:histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,defaultYExtents:!f,drawLinesBetweenPoints:!f,interpolate:linear,radiusRatio:'13',scale:linear,setYExtents:!f,shareYAxis:!t,showCircles:!t,smoothLines:!f,times:!(),yAxis:()),title:'FIM Alerts by hour of day',type:line))"
                        vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="{{_agent.name ? 'AgentName:'+_agent.name : '*'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="50">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline"> Top 5 files changed at the same time</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="histogram" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:syscheck')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(customInterval:'1h',extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1),schema:segment,type:date_histogram),(enabled:!t,id:'3',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:5),schema:group,type:terms)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,defaultYExtents:!f,mode:stacked,scale:linear,setYExtents:!f,shareYAxis:!t,times:!(),yAxis:()),title:'FIM Top 5 files changed at the same time',type:histogram))"
                        vis-filter="{{_agent.name ? 'rule.groups:syscheck AND AgentName:'+_agent.name : 'rule.groups:syscheck'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
        </md-content>

        <md-content layout="row">
            <md-card flex="33">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 10 files changed</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups: &quot;syscheck &quot; AND full_log: &quot;Integrity checksum changed &quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:10),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'FIM Top 10 Changed',type:pie))"
                        vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="{{_agent.name ? 'rule.groups: &quot;syscheck &quot; AND full_log: &quot;Integrity checksum changed &quot; AND AgentName:'+_agent.name : 'rule.groups: &quot;syscheck &quot; AND full_log: &quot;Integrity checksum changed &quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="33">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 10 files added</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups: &quot;syscheck &quot; AND full_log: &quot;added &quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:10),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'FIM Top 10 Added',type:pie))"
                        vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="{{_agent.name ? 'rule.groups: &quot;syscheck &quot; AND full_log: &quot;added &quot; AND AgentName:'+_agent.name : 'rule.groups: &quot;syscheck &quot; AND full_log: &quot;added &quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="33">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 10 files deleted</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups: &quot;syscheck &quot; AND full_log: &quot;was deleted &quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:10),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'FIM Top 10 Deleted',type:pie))"
                        vis-filter="{{_agent.name ? 'rule.groups: &quot;syscheck &quot; AND full_log: &quot;was deleted &quot; AND AgentName:'+_agent.name : 'rule.groups: &quot;syscheck &quot; AND full_log: &quot;was deleted &quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
        </md-content>

        <md-content layout="row">
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 15 changed users</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Ownership was&quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'3',params:(field:SyscheckFile.uname_before,order:desc,orderBy:'1',size:15),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM Top 15 changed users',type:pie))"
                        vis-filter="{{_agent.name ? '&quot;syscheck&quot; AND full_log:&quot;Ownership was&quot; AND AgentName:'+_agent.name : '&quot;syscheck&quot; AND full_log:&quot;Ownership was&quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 15 new users</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Ownership was&quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'3',params:(field:SyscheckFile.uname_after,order:desc,orderBy:'1',size:15),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM Top 15 new users',type:pie))"
                        vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Ownership was&quot; AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Ownership was&quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 15 changed groups</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Group ownership was&quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.gname_before,order:desc,orderBy:'1',size:15),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM Top 15 changed groups',type:pie))"
                        vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Group ownership was&quot; AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Group ownership was&quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 15 new groups</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Group ownership was&quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.gname_after,order:desc,orderBy:'1',size:15),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM Top 15 new groups',type:pie))"
                        vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Group ownership was&quot; AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Group ownership was&quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
        </md-content>


        <md-content layout="row">
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 15 changed permissions</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Permissions changed from&quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.perm_before,order:desc,orderBy:'1',size:15),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM Top 15 changed permissions',type:pie))"
                        vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Permissions changed from&quot; AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Permissions changed from&quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 15 new permissions</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Permissions changed from&quot;')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.perm_after,order:desc,orderBy:'1',size:15),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM Top 15 new permissions',type:pie))"
                        vis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))" vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Permissions changed from&quot; AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND full_log:&quot;Permissions changed from&quot;'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 10 files with Root/Admin owner</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND (SyscheckFile.owner_after:&quot;0&quot; OR SyscheckFile.owner_before:&quot;0&quot; or SyscheckFile.gowner_after:&quot;root&quot; or SyscheckFile.gowner_before:&quot;0&quot;)')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:10),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'FIM Top 10 files with Root/Admin owner',type:pie))"
                        vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND (SyscheckFile.owner_after:&quot;0&quot; OR SyscheckFile.owner_before:&quot;0&quot; or SyscheckFile.gowner_after:&quot;root&quot; or SyscheckFile.gowner_before:&quot;0&quot;) AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND (SyscheckFile.owner_after:&quot;0&quot; OR SyscheckFile.owner_before:&quot;0&quot; or SyscheckFile.gowner_after:&quot;root&quot; or SyscheckFile.gowner_before:&quot;0&quot;)'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
            <md-card flex="25">
                <md-card-title>
                    <md-card-title-text>
                        <span class="md-headline">Top 10 Files converted to executable</span>
                    </md-card-title-text>
                </md-card-title>
                <md-card-content>
                    <kbn-vis vis-height="200px;" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'rule.groups:&quot;syscheck&quot; AND _exists_:SyscheckFile.perm_before AND  (SyscheckFile.perm_after:/[0-7]{3}([1357]%7C[0-7]([1357]%7C[0-7][1357])).*/) AND NOT (SyscheckFile.perm_before:/[0-7]{3}([1357]%7C[0-7]([1357]%7C[0-7][1357])).*/)')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:10),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'FIM Top 10 Files converted to executable',type:pie))"
                        vis-filter="{{_agent.name ? 'rule.groups:&quot;syscheck&quot; AND _exists_:SyscheckFile.perm_before AND  (SyscheckFile.perm_after:/[0-7]{3}([1357]%7C[0-7]([1357]%7C[0-7][1357])).*/) AND NOT (SyscheckFile.perm_before:/[0-7]{3}([1357]%7C[0-7]([1357]%7C[0-7][1357])).*/) AND AgentName:'+_agent.name : 'rule.groups:&quot;syscheck&quot; AND _exists_:SyscheckFile.perm_before AND  (SyscheckFile.perm_after:/[0-7]{3}([1357]%7C[0-7]([1357]%7C[0-7][1357])).*/) AND NOT (SyscheckFile.perm_before:/[0-7]{3}([1357]%7C[0-7]([1357]%7C[0-7][1357])).*/)'}}">
                    </kbn-vis>
                </md-card-content>
            </md-card>
        </md-content>

    </div>
</md-content>