<md-content ng-if="submenuNavItem == 'fim'" ng-if="_agent" id="agents-fim">
<kbn-searchbar></kbn-searchbar>
    <div flex ng-controller="fimController" layout="column">
        <md-progress-linear class="md-accent" md-mode="indeterminate" ng-show="load"></md-progress-linear>
			<md-content layout="row">
				<md-card flex>
				<md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Events</span>
                        </md-card-title-text>
                    </md-card-title>
				<kbn-vis vis-height="160px" vis-type="histogram" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(vis:(legendOpen:!f)),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(customInterval:'2h',extended_bounds:(),field:'@timestamp',interval:'auto',min_doc_count:1),schema:segment,type:date_histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,defaultYExtents:!f,mode:stacked,scale:linear,setYExtents:!f,shareYAxis:!t,times:!(),yAxis:()),title:'New%20Visualization',type:histogram))"
					vis-filter="location: syscheck"
					>
				</kbn-vis>
				</md-card>
			</md-content>
            <md-content layout="row">
                <md-card flex="20">
                    <md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Users</span>
                        </md-card-title-text>
                    </md-card-title>
                    <md-card-content>
                        <kbn-vis vis-height="100px" vis-type="pie" vis-index-pattern="ossec-*"
						vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'3',params:(field:SyscheckFile.uname_after,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM%20Top%2015%20new%20users2',type:pie))"
	
					    vis-filter="location: syscheck AND {{'AgentName:'+_agent.name}}">
                        </kbn-vis>
                    </md-card-content>
                </md-card>
                <md-card flex="20">
                    <md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Groups</span>
                        </md-card-title-text>
                    </md-card-title>
                    <md-card-content>
                        <kbn-vis vis-height="100px" vis-type="pie" vis-index-pattern="ossec-*" 
							vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'3',params:(field:SyscheckFile.gname_after,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!t,shareYAxis:!t),title:'FIM%20Top%2015%20new%20users',type:pie))"
                            vis-filter="location: syscheck AND {{'AgentName:'+_agent.name}}">
                        </kbn-vis>
                    </md-card-content>
                </md-card>

                <md-card flex="20">
                    <md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Files added</span>
                        </md-card-title-text>
                    </md-card-title>
                    <md-card-content>
                        <kbn-vis vis-height="100px" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'New%20Visualization',type:pie))"
							vis-filter='rule.sidid: 554 AND AgentName: {{_agent.name}} NOT location: syscheck-registry'>
                        </kbn-vis>
                    </md-card-content>
                </md-card>
				
				<md-card flex="20">
                    <md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Files modified</span>
                        </md-card-title-text>
                    </md-card-title>
                    <md-card-content>
                        <kbn-vis vis-height="100px" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'FIM%20Top%2010%20Changed',type:pie))"
							vis-filter='(rule.sidid: 550 OR rule.sidid: 551 OR rule.sidid: 552 OR rule.sidid: 555) AND AgentName: {{_agent.name}} NOT location: syscheck-registry'>
                        </kbn-vis>
                    </md-card-content>
                </md-card>
				
				<md-card flex="20">
                    <md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Files deleted</span>
                        </md-card-title-text>
                    </md-card-title>
                    <md-card-content> 
                        <kbn-vis vis-height="100px" vis-type="pie" vis-index-pattern="ossec-*" vis-a="(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(field:SyscheckFile.path,order:desc,orderBy:'1',size:5),schema:segment,type:terms)),listeners:(),params:(addLegend:!t,addTooltip:!t,isDonut:!f,shareYAxis:!t),title:'New%20Visualization',type:pie))"
							vis-filter='rule.sidid: 553 AND AgentName: {{_agent.name}} NOT location: syscheck-registry'>
                        </kbn-vis>
                    </md-card-content> 
                </md-card>
            </md-content>
			
            <div layout="row" layout-align="space-between stretch" ng-show="false">
                    <md-input-container layout="row" class="sideNavBox" flex="40">
                        <label for="searchBox">Search</label>
                        <input type="text" id="searchBox" ng-model="$parent._fileSearch" ng-change="fileSearchFilter($parent._fileSearch)" flex>
                    </md-input-container>
                    <div flex="40"></div>
                    <md-content flex="40" class="subNavLine" layout="row" layout-align="end center" ng-show="isWindows">
                        <md-button ng-click="changeType()" class="md-primary" ng-class="!$parent.showFilesRegistry ? 'button-disabled' : 'button-active'">
                            Files
                        </md-button>
                        <md-button ng-click="changeType()" class="md-primary" ng-class="$parent.showFilesRegistry ? 'button-disabled' : 'button-active'">
                            Registry keys
                        </md-button>
                    </md-content>
                    <md-input-container style="margin-top: 12px;" flex="20">
                        <md-select id="eventBox" ng-model="$parent._fimEvent" ng-change="fileEventFilter($parent._fimEvent)" aria-label="Filter by event">
                            <md-option value="all">Filter events</md-option>
                            <md-option value="added">Added</md-option>
                            <md-option value="modified">Modified</md-option>
                            <md-option value="readded">Re-added</md-option>
                            <md-option value="deleted">Deleted</md-option>
                        </md-select>
                    </md-input-container>
               </div>
			<div layout="row" layout-align="space-between stretch">
					<md-card flex="100">
					<md-card-title>
                        <md-card-title-text>
                            <span class="md-headline">Last events</span>
                        </md-card-title-text>
                    </md-card-title>
					<kbn-dis table-height="600px" dis-a="(columns:!(SyscheckFile.path,SyscheckFile.event,SyscheckFile.uname_after,SyscheckFile.gname_after,full_log),index:'ossec-*',interval:auto,query:(query_string:(analyze_wildcard:!t,query:'location:%20syscheck')),sort:!('@timestamp',desc))"
					dis-g="(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-{{timerFilterValue}},mode:quick,to:now))"
					dis-filter="location: syscheck AND {{'AgentName:'+_agent.name}}"
					infinite-scroll="true">
					</kbn-dis>
					</md-card>
				
           </div>	
               
			</div>
			
			</md-content>
